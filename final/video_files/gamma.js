!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/.bootscripts/",n(n.s=303)}({154:function(e,t,n){"use strict";var i=n(160),o=0;function r(){var e="phxMark:"+o++;return i.mark(e),e}e.exports=function(e){var t=r();return{end:function(){var n=r();i.measure(e,t,n);var o=i.getEntriesByName(e);if(o&&o.length)return o[o.length-1].duration}}}},160:function(e,t,n){"use strict";var i,o=function(){};try{i=window}catch(e){i={}}i.performance&&i.performance.mark?e.exports=i.performance:e.exports={getEntriesByName:o,mark:o,measure:o}},183:function(e,t,n){"use strict";e.exports=function(e){var t=(n=e,window[n]=window[n]||[],window[n]);var n;return new Promise((function(e,n){t.push((function(){e(this)}))}))}},22:function(e,t,n){"use strict";e.exports=function(e,t){var n=window[e];if(window[e]={push:o},void 0!==n)for(var i=0;i<n.length;i++)o(n[i]);function o(e){t.then?t.then((function(n){t=n,e.call(t)})):e.call(t)}}},240:function(e,t,n){var i;void 0===(i=function(){"use strict";return function(e){return e.replace(/^https?:\/\//,"").replace(/[:\/].*/,"").toLowerCase().replace(/^www\./,"").replace(/^m\./,"").replace(/\.blogspot(\.com?)?\.[a-z]{2,3}$/,".blogspot.com").replace(/^.*\.(gamepedia|wikia)(\.com?)?\.[a-z]{2,3}$/,"$1.com").split(".").slice(-3).join(".")}}.apply(t,[]))||(e.exports=i)},303:function(e,t,n){"use strict";var i=n(22),o=n(183),r=n(304),a=n(305);window.phxConfigQueue.push((function(){var e=window.GdprStatus,t=this.user.hasPremium(),s=new a({fetch:window.fetch,window:window}),u=this.features.isEnabled("use-mavenuid-demonitized")||this.features.isEnabled("use-mavenuid-demonetized"),c=window.document.location.hash&&-1!==window.document.location.hash.indexOf("phxAdvertisingDebug")?function(){var e=Array.prototype.slice.apply(arguments);e.unshift("%c[phxAdvertisingDebug]%c","font-weight:bold","font-weight:normal"),console.log.apply(console,e)}:void 0;e.isDemonetizedSafe().then((function(e){var a=!!u&&e;c&&(a||t)&&c(t?"ADS402 Premium":"ADS401 Demonetized"),i("phxAdvertisingQueue",new r({adServerPromise:o("phxAdServerQueue"),breakpointPromise:o("phxConfigQueue").then((function(e){return e.breakpoint.get()})),clientPageModelPromise:n(306),debugLog:c,demographics:s,document:window.document,forceAllSlotsEmpty:t||a,adAuctionPromise:o("phxAdAuctionQueue"),timedOutPageLoadPromise:window.getTimedOutPageLoadPromise(3e4)}))})),i("phxDemographicsQueue",s)}))},304:function(e,t,n){"use strict";var i=n(154);function o(e,t,n,i){var o=this;o.pageId=t,o.config=n;var r=e.debugLog,a={},s={};function u(){return t===e.pageId}r("adServer.initPage");var c=e.adServerPromise.then((function(e){if(u())return e.initPage().then((function(){return r("adServer.initPage completed"),e}));throw new Error("Page not current")}));o.makeInitialAdCall=function(){var t;return e.adAuctionPromise.then((function(e){return t=e,e.getLatestResult()})).then((function(i){var o=[];return n.sizedSlots.forEach((function(t){e.resetAdSlot(t.id),t.model.deferLoad||o.push(t)})),n.outOfPageSlots&&n.outOfPageSlots.forEach((function(t){e.resetAdSlot(t.id),o.push(t)})),h(o,t,i)}))},o.makeOutOfPageAdCall=function(){var t;return e.adAuctionPromise.then((function(e){return t=e,e.getLatestResult()})).then((function(e){return h(n.outOfPageSlots||[],t,e)}))},o.makeDynamicAdCall=function(t,n){var i;return e.adAuctionPromise.then((function(e){return i=e,n.auctionId?e.getResultById(n.auctionId):e.getLatestResult()})).then((function(e){return h(n.slots,i,e)}))},o.getSlotResult=function(e){return v(e)},o.close=function(){r("close page",t),Object.keys(s).map((function(e){s[e].reject(new Error("cancelled by navigation"))}))};var d={},l={},f=!1,m=0;function h(a,s,h){if(e.forceAllSlotsEmpty)return r("all slots on page",t,"forced empty by configuration"),function(t){var n=t.map((function(t){var n=e.document.getElementById(t.id);return n?Promise.resolve({slotId:t.id,element:n,filled:!1,sizeCode:null}).then((function(e){return g(e),e})):Promise.reject(new Error("missing container element for ad "+t.id))}));return Promise.all(n)}(a);var p=window.GdprStatus,v=[c,e.clientPageModelPromise,e.breakpointPromise,p.isApplicable(),p.countryCodeSafe(),i];return Promise.all(v).then((function(i){if(!u())return r("ignoring prereqs for defunct page",t),void Promise.reject("Page not current");var c=i[0],v=i[1],b=i[2],P=i[3];r("requesting for page",t,"slots with screenSize",b);var w={};P&&(w={donottrack:!0,gdprIsApplicable:!0,gdprIsConsentGivenPromise:p.waitForConsentValue().then((function(){return p.isConsentGivenForPurpose(p.PURPOSE_IDS.advertising)})),kuid:void 0,optout:!0});var y=Object.assign({},n.global.baseModel,v,w,s&&s.keyValues||{}),S=a.filter((function(e){return!e.screenSizes||-1!==e.screenSizes.indexOf(b)}));e.hasAdhesionAndFixedBottomZone&&(S=function(t,n){if(d){var i=t.filter((function(e){var t=e.model.zone;return"adhesion"!==t&&"fixed_bottom"!==t||(d[t]=e,n&&(l[t]=n.getMaxBidForAdUnit(e.id)),!1)}));if("fixed_bottom"in d&&"adhesion"in d){var r=function(){m++;var e=o.config.global.config.expectedRefreshCount;return null==e&&(e=6),"fixed_bottom"in l?0===l.fixed_bottom?"fixed_bottom":"fixed_bottom"in l&&"adhesion"in l?l.adhesion<=l.fixed_bottom*Math.max(e-(m-1),1)?"fixed_bottom":"adhesion":"fixed_bottom":"adhesion"}();if(i.push(d[r]),delete d[r],"adhesion"===r){if(f=!0,d.fixed_bottom){var a=e.document.getElementById(d.fixed_bottom.id);if(a){var s=a.closest("phoenix-ad");s&&s.parentElement.removeChild(s)}}d=void 0}}return i}return f&&(t=t.filter((function(e){return"fixed_bottom"!==e.model.zone}))),t}(S,h)),(S=S.map((function(t){var i={};h&&(i=h.getSlotModelPropertiesForAdUnit(t.id));var o,r,a,s=e.document.getElementById(t.id);return s?{id:t.id,adUnitPath:t.adUnitPath,config:t.config,element:s,model:Object.assign({},t.model,(o=n.global.baseModel,r=t.model,a=Math.min(r.index,4),{zoneIndex:r.zone+"_"+a,siteZoneIndex:o.hostname+"_"+r.zone+"_"+a}),i)}:(console.warn("missing container element for ad",t.id),null)})).filter((function(e){return!!e}))).forEach((function(t){var n;if(!t.model.isOutstream){var i=t.element.parentElement;if(i){var o='[data-ad-group="'+i.parentElement.getAttribute("data-ad-group")+'"]',r=e.document.querySelectorAll(o+".not-size-"+b),a={D:!0};for(n=0;n<r.length;n++){var s=r[n];["A","B","C"].forEach((function(e){s.classList.contains("not-size-"+e)||(a[e]=!0)})),s.parentElement.removeChild(s)}var u=e.document.querySelectorAll(o);for(n=0;n<u.length;n++)Object.keys(a).forEach((function(e){var t="not-size-"+e;u[n].classList.remove(t),i.classList.remove(t)}))}}}));var x=new Promise((function(e){if("visible"!==document.visibilityState){document.addEventListener("visibilitychange",(function t(n){"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",t),e(!0))}),!1)}else e(!0)}));return x.then((function(){return r("adServer.requestAds",S),c.requestAds(n.global.config,y,S,h,x).then((function(e){return e.map((function(e){return e.then((function(e){return e&&g(e),e}))}))})).then((function(e){return Promise.all(e)}))}))}))}function g(e){var t=e.element,n=e.filled,i=e.sizeCode,o=e.sizeDims,r=t.parentElement,a=r.parentElement;if(r.classList.remove("is-placeholder"),!n)return a.classList.add("is-empty"),r.classList.add("is-empty"),a.classList.remove("is-loaded"),r.classList.remove("is-loaded"),void p(e);a.classList.add("is-loaded"),r.classList.add("is-loaded"),a.classList.remove("is-empty"),r.classList.remove("is-empty"),t.setAttribute("data-ad-size",i);var s=a.getAttribute("data-class-rules");if(s){var u,c,d=JSON.parse(s);for(u=0;u<d.length;u++){var l=d[u];if(l.sizes&&-1!==l.sizes.indexOf(i)||l.sizes&&-1!==l.sizes.indexOf(o)||l.dimensions&&-1!==l.dimensions.indexOf(o))for(c=0;c<l.classes.length;c++)a.classList.add(l.classes[c]);else for(c=0;c<l.classes.length;c++)-1!==a.classList.contains(l.classes[c])&&a.classList.remove(l.classes[c])}}p(e)}function p(e){e.slotId&&(v(e.slotId),s[e.slotId]&&s[e.slotId].resolve(e))}function v(e){return a[e]||(a[e]=new Promise((function(t,n){s[e]={resolve:t,reject:n}})).then((function(t){return delete s[e],t}),(function(t){throw delete s[e],t}))),a[e]}}e.exports=function(e){e=e||{},this.adServerPromise=e.adServerPromise,this.breakpointPromise=e.breakpointPromise,this.clientPageModelPromise=e.clientPageModelPromise,this.demographics=e.demographics,this.document=e.document,this.adAuctionPromise=e.adAuctionPromise,this.timedOutPageLoadPromise=e.timedOutPageLoadPromise,this.forceAllSlotsEmpty=!!e.forceAllSlotsEmpty,this.debugLog=e.debugLog||function(){};var t=this.debugLog;t("new Session with options",e);var n,r=this;r.pageId=0,r.dynamicCallId=0;var a,s=new Promise((function(e,t){n=e}));r.beginPage=function(e){var s=++r.pageId,u=i("advertising:beginPage:"+s);function c(t){return e.sizedSlots.some((function(e){return e.model.zone===t}))}return a&&a.close(),r.hasAdhesionAndFixedBottomZone=c("adhesion")&&c("fixed_bottom"),t("begin page",s,e),a=new o(r,s,e,r.timedOutPageLoadPromise),1===s&&n(),t("page",s,"initial ad call"),a.makeInitialAdCall().then((function(e){return t("page",s,"initial ad call result:",e),u.end(),e}),(function(e){return t("page",s,"initial ad call failed:",e),u.end(),Promise.reject(e)}))},r.getPage=function(){return s.then((function(){return a}))},r.getAdCallConfig=function(e,t){return Promise.all([r.adServerPromise,s]).then((function(n){var i=n[0],o=a.config.global.config;return i.getAdCallConfig(e,t,o)}))},r.resetAdSlot=function(e){r.adServerPromise.then((function(t){t.resetAdSlot(e)}))},r.dynamicCall=function(e){var n=++r.dynamicCallId;t("dynamic call",n,e);var o=i("advertising:dynamicCall:"+n);return s.then((function(){return a.makeDynamicAdCall(n,e).then((function(e){return t("dynamic call",n,"result:",e),o.end(),e}))})).catch((function(e){return t("dynamic call",n,"failed:",e),o.end(),Promise.reject(e)}))},r.getSlotResult=function(e){if(!a)throw new Error("cannot call getSlotResult before a page is active");return a.getSlotResult(e)},r.reloadAd=function(e,t){return r.getSlotResult(e.id).then((function(){return r.resetAdSlot(e.id),r.dynamicCall({slots:[e],auctionId:t})})).catch((function(t){console.warn(t),r.dynamicCall({slots:[e]})}))}}},305:function(e,t,n){"use strict";var i=n(154),o=0,r=0;e.exports=function(e){var t,n,a=e.fetch,s=e.window,u=new Promise((function(e,t){n=e}));this.init=function(e){e.addressableDemographics=e.addressableDemographics||{US:{},CA:{},GB:{}},n(e)},this.location=function(){return t||(t=a(function(e,t){var n,i=s.envShortName&&"PROD"!==s.envShortName?"https://dove.qa.saymedia.com":"https://dove.saymedia.com";if(t){var o=encodeURIComponent;n=Object.keys(t).map((function(e){return o(e)+"="+o(t[e])})).join("&")}return i+"/"+e+(n?"?"+n:"")}("user/location"),{credentials:"include"}).then((function(e){return e.json()}))),t},this.implicit=function(e){var t=this,n=i("advertising.demographics.implicit:"+r++);return u.then((function(e){return t.location().catch((function(){return{}})).then((function(t){var n=t.country||"US";if(e.addressableDemographics.hasOwnProperty(n))return e.addressableDemographics[n];throw new Error(n+" is not a valid country code.")}))})).then((function(e){return n.end(),e}))},this.get=function(){var e=i("advertising.demographics.get:"+o++);return this.implicit().catch((function(){return null})).then((function(e){var t=e.shift();if(t)return t=Object.keys(t).reduce((function(e,n){return!0===t[n]&&(e[n]=!0),e}),{}),Object.keys(t)})).then((function(t){return e.end(),t}))}}},306:function(e,t,n){"use strict";var i=n(240);e.exports=Promise.resolve({referrer:function(){var e;try{window.top.document.referrer&&(e=window.top.document.referrer)}catch(t){e=document.referrer}if(e)return i(e)}()})}});
//# sourceMappingURL=advertising.min.js.map